--- libvirt-1.2.9.orig/src/libvirt.c
+++ libvirt-1.2.9/src/libvirt.c
@@ -21547,6 +21547,7 @@ virConnectGetDomainCapabilities(virConne
     virResetLastError();
 
     virCheckConnectReturn(conn, NULL);
+    virCheckReadOnlyGoto(conn->flags, error);
 
     if (conn->driver->connectGetDomainCapabilities) {
         char *ret;
